# API Security Headers
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "DENY"
    Header set X-XSS-Protection "1; mode=block"
</IfModule>

# Protect sensitive files
<FilesMatch "\.(php|inc|sql|log|env)$">
    Require all denied
</FilesMatch>

<Files "config.php">
    Require all denied
</Files>

# Allow only specific PHP files
<FilesMatch "^(books|auth|settings|calendar|social)\.php$">
    Require all granted
</FilesMatch>

# Rewrite API endpoints
RewriteEngine On
RewriteBase /api/

# Redirect to specific endpoints
RewriteRule ^books/?$ books.php [L,QSA]
RewriteRule ^auth/?$ auth.php [L,QSA]
RewriteRule ^settings/?$ settings.php [L,QSA]
RewriteRule ^calendar/?$ calendar.php [L,QSA]
RewriteRule ^social/?$ social.php [L,QSA]

# Deny access to everything else
RewriteRule ^.*$ - [F,L]
